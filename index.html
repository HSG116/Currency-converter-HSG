<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HSG - محول العملات المتقدم</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #4a6bff;
            --primary-dark: #3a56d4;
            --secondary-color: #f8f9fa;
            --accent-color: #ff6b6b;
            --success-color: #28a745;
            --text-color: #333;
            --light-text: #666;
            --border-color: #ddd;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --shadow-hover: 0 8px 15px rgba(0, 0, 0, 0.15);
            --border-radius: 12px;
            --transition: all 0.3s ease;
            --gradient: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Tajawal', sans-serif;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: var(--text-color);
            line-height: 1.6;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .loader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.95);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            transition: opacity 0.5s ease;
        }

        .loader.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .loader-spinner {
            width: 60px;
            height: 60px;
            border: 5px solid var(--primary-color);
            border-radius: 50%;
            border-top-color: transparent;
            animation: spin 1s linear infinite;
            margin-bottom: 1.5rem;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .loader p {
            font-size: 1.3rem;
            color: var(--primary-color);
            font-weight: 500;
        }

        .container {
            width: 100%;
            max-width: 500px;
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-hover);
            overflow: hidden;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.5s ease;
        }

        .container.visible {
            opacity: 1;
            transform: translateY(0);
        }

        header {
            background: var(--gradient);
            color: white;
            padding: 1.5rem 2rem;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.1);
            transform: rotate(30deg);
        }

        .logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            z-index: 1;
        }

        .logo-icon {
            font-size: 2.5rem;
            background: rgba(255, 255, 255, 0.2);
            width: 70px;
            height: 70px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .logo-text h1 {
            font-size: 1.8rem;
            margin-bottom: 0.3rem;
        }

        .logo-text p {
            font-size: 1rem;
            opacity: 0.9;
        }

        .last-update {
            background-color: rgba(255, 255, 255, 0.2);
            padding: 0.7rem 1rem;
            border-radius: var(--border-radius);
            font-size: 0.9rem;
            backdrop-filter: blur(10px);
            margin-top: 1rem;
            display: inline-block;
            z-index: 1;
        }

        .converter-container {
            padding: 2rem;
        }

        .amount-section, .currency-section, .result-section {
            margin-bottom: 1.5rem;
        }

        label {
            display: block;
            margin-bottom: 0.7rem;
            font-weight: 500;
            color: var(--light-text);
            font-size: 1rem;
        }

        input {
            width: 100%;
            padding: 1rem;
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius);
            font-size: 1.1rem;
            transition: var(--transition);
            font-weight: 600;
            text-align: center;
        }

        input:focus {
            border-color: var(--primary-color);
            outline: none;
            box-shadow: 0 0 0 3px rgba(74, 107, 255, 0.2);
        }

        .currency-section {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 1.5rem;
            align-items: end;
        }

        .select-wrapper {
            position: relative;
        }

        .select-wrapper::after {
            content: '\f078';
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            position: absolute;
            top: 50%;
            left: 15px;
            transform: translateY(-50%);
            color: var(--light-text);
            pointer-events: none;
        }

        select {
            width: 100%;
            padding: 1rem 1.5rem 1rem 1rem;
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius);
            font-size: 1rem;
            appearance: none;
            background-color: white;
            transition: var(--transition);
            font-weight: 500;
            cursor: pointer;
        }

        select:focus {
            border-color: var(--primary-color);
            outline: none;
            box-shadow: 0 0 0 3px rgba(74, 107, 255, 0.2);
        }

        .swap-btn {
            background: var(--gradient);
            color: white;
            border: none;
            width: 55px;
            height: 55px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
            box-shadow: 0 4px 8px rgba(74, 107, 255, 0.3);
            margin-bottom: 1rem;
            font-size: 1.2rem;
        }

        .swap-btn:hover {
            transform: rotate(180deg) scale(1.1);
            box-shadow: 0 6px 12px rgba(74, 107, 255, 0.4);
        }

        .result {
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--primary-color);
            text-align: center;
            margin: 1.5rem 0;
            padding: 1.5rem;
            background: var(--secondary-color);
            border-radius: var(--border-radius);
            border: 2px dashed var(--border-color);
            transition: var(--transition);
        }

        .rate {
            text-align: center;
            color: var(--light-text);
            font-size: 1.1rem;
            margin-bottom: 1.5rem;
            min-height: 1.5rem;
        }

        .convert-btn {
            width: 100%;
            padding: 1.2rem;
            background: var(--gradient);
            color: white;
            border: none;
            border-radius: var(--border-radius);
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.8rem;
            box-shadow: 0 4px 8px rgba(74, 107, 255, 0.3);
        }

        .convert-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(74, 107, 255, 0.4);
        }

        .convert-btn:active {
            transform: translateY(-1px);
        }

        .error-message {
            color: var(--accent-color);
            text-align: center;
            padding: 0.5rem;
            font-weight: 500;
            display: none;
        }

        .success-message {
            color: var(--success-color);
            text-align: center;
            padding: 0.5rem;
            font-weight: 500;
            display: none;
        }

        .success-animation {
            animation: pulse 0.5s ease;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        footer {
            text-align: center;
            padding: 1.5rem;
            color: var(--light-text);
            font-size: 0.9rem;
            background: var(--secondary-color);
            border-top: 1px solid var(--border-color);
        }

        footer p {
            margin-bottom: 0.5rem;
        }

        #api-source {
            color: var(--primary-color);
            font-weight: bold;
        }

        /* تحسينات للشاشات الصغيرة */
        @media (max-width: 768px) {
            .currency-section {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
            
            .swap-btn {
                margin: 0 auto;
            }
            
            header {
                padding: 1.2rem;
            }
            
            .logo {
                flex-direction: column;
                text-align: center;
                gap: 0.5rem;
            }
            
            .logo-icon {
                width: 60px;
                height: 60px;
                font-size: 2rem;
            }
            
            .converter-container {
                padding: 1.5rem;
            }
            
            .result {
                font-size: 2rem;
            }
        }

        @media (max-width: 480px) {
            .container {
                max-width: 100%;
            }
            
            .result {
                font-size: 1.8rem;
            }
        }
    </style>
</head>
<body>
    <div class="loader" id="loader">
        <div class="loader-spinner"></div>
        <p>جاري تحميل البيانات...</p>
    </div>

    <div class="container" id="content">
        <header>
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-exchange-alt"></i>
                </div>
                <div class="logo-text">
                    <h1>HSG Currency</h1>
                    <p>أداة تحويل العملات المتقدمة</p>
                </div>
            </div>
            <div class="last-update">
                <span id="update-time">آخر تحديث: <span id="current-time">--:--:--</span></span>
            </div>
        </header>

        <div class="converter-container">
            <div class="amount-section">
                <label for="amount">المبلغ:</label>
                <input type="number" id="amount" value="1" min="0" step="0.01" placeholder="أدخل المبلغ">
            </div>
            
            <div class="currency-section">
                <div class="currency-from">
                    <label for="from-currency">من:</label>
                    <div class="select-wrapper">
                        <select id="from-currency"></select>
                    </div>
                </div>
                
                <button id="swap-currencies" class="swap-btn" aria-label="مبادلة العملات">
                    <i class="fas fa-exchange-alt"></i>
                </button>
                
                <div class="currency-to">
                    <label for="to-currency">إلى:</label>
                    <div class="select-wrapper">
                        <select id="to-currency"></select>
                    </div>
                </div>
            </div>
            
            <div class="result-section">
                <div class="result" id="result">0.00</div>
                <div class="rate" id="rate">1 USD = 0.00 EUR</div>
                <div class="error-message" id="error-message"></div>
                <div class="success-message" id="success-message"></div>
            </div>
            
            <button id="convert-btn" class="convert-btn">
                <i class="fas fa-sync-alt"></i> تحديث الآن
            </button>
        </div>
        
        <footer>
            <p>© 2023 HSG Currency Converter - جميع الحقوق محفوظة</p>
            <p>بيانات الأسعار يتم تحديثها كل ثانية</p>
        </footer>
    </div>

    <script>
        // DOM elements
        const amountInput = document.getElementById('amount');
        const fromCurrencySelect = document.getElementById('from-currency');
        const toCurrencySelect = document.getElementById('to-currency');
        const resultDiv = document.getElementById('result');
        const rateDiv = document.getElementById('rate');
        const convertBtn = document.getElementById('convert-btn');
        const swapBtn = document.getElementById('swap-currencies');
        const currentTimeSpan = document.getElementById('current-time');
        const loader = document.getElementById('loader');
        const content = document.getElementById('content');
        const errorMessage = document.getElementById('error-message');
        const successMessage = document.getElementById('success-message');

        // Global variables
        let exchangeRates = {};
        let currencies = [];
        let updateInterval;
        let isLoading = true;

        // قائمة العملات المتاحة
        const CURRENCY_LIST = [
            { code: 'AED', name: 'الدرهم الإماراتي' },
            { code: 'ARS', name: 'البيزو الأرجنتيني' },
            { code: 'AUD', name: 'الدولار الأسترالي' },
            { code: 'BGN', name: 'ليف البلغاري' },
            { code: 'BRL', name: 'الريال البرازيلي' },
            { code: 'BSD', name: 'الدولار البهامي' },
            { code: 'CAD', name: 'الدولار الكندي' },
            { code: 'CHF', name: 'الفرنك السويسري' },
            { code: 'CLP', name: 'البيزو التشيلي' },
            { code: 'CNY', name: 'اليوان الصيني' },
            { code: 'COP', name: 'البيزو الكولومبي' },
            { code: 'CZK', name: 'الكرونة التشيكية' },
            { code: 'DKK', name: 'الكرونة الدنماركية' },
            { code: 'DOP', name: 'البيزو الدومينيكي' },
            { code: 'EGP', name: 'الجنيه المصري' },
            { code: 'EUR', name: 'اليورو' },
            { code: 'FJD', name: 'الدولار الفيجي' },
            { code: 'GBP', name: 'الجنيه الإسترليني' },
            { code: 'GTQ', name: 'الكويتزال الغواتيمالي' },
            { code: 'HKD', name: 'الدولار الهونغ كونغي' },
            { code: 'HRK', name: 'الكونا الكرواتية' },
            { code: 'HUF', name: 'الفورنت المجري' },
            { code: 'IDR', name: 'الروبية الإندونيسية' },
            { code: 'ILS', name: 'الشيكل الفلسطيني' },
            { code: 'INR', name: 'الروبية الهندية' },
            { code: 'ISK', name: 'الكرونا الآيسلندية' },
            { code: 'JPY', name: 'الين الياباني' },
            { code: 'KRW', name: 'الوون الكوري الجنوبي' },
            { code: 'KZT', name: 'التنغ الكازاخستاني' },
            { code: 'MXN', name: 'البيزو المكسيكي' },
            { code: 'MYR', name: 'الرينغيت الماليزي' },
            { code: 'NOK', name: 'الكرونا النرويجية' },
            { code: 'NZD', name: 'الدولار النيوزيلندي' },
            { code: 'PAB', name: 'البالبوا البنمي' },
            { code: 'PEN', name: 'السول البيروفي' },
            { code: 'PHP', name: 'البيزو الفلبيني' },
            { code: 'PKR', name: 'الروبية الباكستانية' },
            { code: 'PLN', name: 'الزلوتي البولندي' },
            { code: 'PYG', name: 'الغواراني الباراغواياني' },
            { code: 'RON', name: 'الليو الروماني' },
            { code: 'RUB', name: 'الروبل الروسي' },
            { code: 'SAR', name: 'الريال السعودي' },
            { code: 'SEK', name: 'الكرونا السويدية' },
            { code: 'SGD', name: 'الدولار السنغافوري' },
            { code: 'THB', name: 'البات التايلاندي' },
            { code: 'TRY', name: 'الليرة التركية' },
            { code: 'TWD', name: 'الدولار التايواني' },
            { code: 'UAH', name: 'الهريفنيا الأوكرانية' },
            { code: 'USD', name: 'الدولار الأمريكي' },
            { code: 'UYU', name: 'البيزو الأوروغواياني' },
            { code: 'VND', name: 'الدونغ الفيتنامي' },
            { code: 'ZAR', name: 'الراند الجنوب أفريقي' }
        ];

        // تهيئة التطبيق
        function init() {
            populateCurrencySelects();
            setupEventListeners();
            startAutoUpdate();
            startClock();
            
            // إخفاء Loader وإظهار المحتوى بعد تأخير بسيط
            setTimeout(() => {
                isLoading = false;
                loader.classList.add('hidden');
                content.classList.add('visible');
            }, 1000);
        }

        // تعبئة قوائم اختيار العملات
        function populateCurrencySelects() {
            // مسح القوائم الحالية
            fromCurrencySelect.innerHTML = '';
            toCurrencySelect.innerHTML = '';
            
            CURRENCY_LIST.forEach(currency => {
                const option1 = document.createElement('option');
                option1.value = currency.code;
                option1.textContent = `${currency.code} - ${currency.name}`;
                
                const option2 = option1.cloneNode(true);
                
                fromCurrencySelect.appendChild(option1);
                toCurrencySelect.appendChild(option2);
            });
            
            // تعيين العملات الافتراضية
            const usdIndex = CURRENCY_LIST.findIndex(c => c.code === 'USD');
            const eurIndex = CURRENCY_LIST.findIndex(c => c.code === 'EUR');
            
            if (usdIndex !== -1) fromCurrencySelect.selectedIndex = usdIndex;
            if (eurIndex !== -1) toCurrencySelect.selectedIndex = eurIndex;
            
            // إجراء تحويل أولي
            convert();
        }

        // تحويل العملات باستخدام API
        async function convert() {
            if (isLoading) return;
            
            const amount = parseFloat(amountInput.value);
            if (isNaN(amount) || amount < 0) {
                showError('الرجاء إدخال مبلغ صحيح');
                return;
            }
            
            const fromCurrency = fromCurrencySelect.value;
            const toCurrency = toCurrencySelect.value;
            
            if (fromCurrency === toCurrency) {
                resultDiv.textContent = amount.toFixed(2);
                rateDiv.textContent = `1 ${fromCurrency} = 1 ${toCurrency}`;
                hideError();
                showSuccess('تم التحويل بنجاح');
                resultDiv.classList.add('success-animation');
                setTimeout(() => resultDiv.classList.remove('success-animation'), 500);
                return;
            }
            
            try {
                // إظهار حالة التحميل
                resultDiv.textContent = '...';
                rateDiv.textContent = 'جاري التحويل...';
                hideError();
                hideSuccess();
                
                // استخدام API مجاني للتحويل
                const response = await fetch(`https://api.exchangerate-api.com/v4/latest/${fromCurrency}`);
                const data = await response.json();
                
                if (data.rates && data.rates[toCurrency]) {
                    const rate = data.rates[toCurrency];
                    const convertedAmount = (amount * rate).toFixed(2);
                    
                    resultDiv.textContent = convertedAmount;
                    rateDiv.textContent = `1 ${fromCurrency} = ${rate.toFixed(6)} ${toCurrency}`;
                    
                    // إظهار تأثير النجاح
                    showSuccess('تم التحويل بنجاح');
                    resultDiv.classList.add('success-animation');
                    setTimeout(() => resultDiv.classList.remove('success-animation'), 500);
                } else {
                    throw new Error('العملة غير مدعومة');
                }
            } catch (error) {
                console.error('Conversion error:', error);
                let errorMsg = 'فشل في تحويل العملة. يرجى المحاولة لاحقاً.';
                
                if (error.message.includes('exceeded')) {
                    errorMsg = 'تم تجاوز حد الاستخدام للـ API. يرجى المحاولة لاحقاً.';
                } else if (error.message.includes('غير مدعومة')) {
                    errorMsg = 'العملة غير مدعومة. يرجى اختيار عملة أخرى.';
                }
                
                showError(errorMsg);
            }
        }

        // بدء التحديث التلقائي
        function startAutoUpdate() {
            // تحديث كل ثانية
            updateInterval = setInterval(convert, 1000);
        }

        // بدء الساعة
        function startClock() {
            function updateClock() {
                const now = new Date();
                currentTimeSpan.textContent = now.toLocaleTimeString('ar-EG', {
                    hour: '2-digit',
                    minute: '2-digit',
                    second: '2-digit'
                });
            }
            
            updateClock();
            setInterval(updateClock, 1000);
        }

        // مبادلة العملات
        function swapCurrencies() {
            const temp = fromCurrencySelect.value;
            fromCurrencySelect.value = toCurrencySelect.value;
            toCurrencySelect.value = temp;
            convert();
        }

        // عرض رسالة خطأ
        function showError(message) {
            errorMessage.textContent = message;
            errorMessage.style.display = 'block';
            resultDiv.textContent = '0.00';
            rateDiv.textContent = '---';
            hideSuccess();
        }

        // إخفاء رسالة الخطأ
        function hideError() {
            errorMessage.style.display = 'none';
        }

        // عرض رسالة نجاح
        function showSuccess(message) {
            successMessage.textContent = message;
            successMessage.style.display = 'block';
            setTimeout(() => {
                hideSuccess();
            }, 3000);
        }

        // إخفاء رسالة النجاح
        function hideSuccess() {
            successMessage.style.display = 'none';
        }

        // إعداد معالجي الأحداث
        function setupEventListeners() {
            convertBtn.addEventListener('click', convert);
            swapBtn.addEventListener('click', swapCurrencies);
            
            amountInput.addEventListener('input', convert);
            fromCurrencySelect.addEventListener('change', convert);
            toCurrencySelect.addEventListener('change', convert);
        }

        // تهيئة التطبيق عند تحميل الصفحة
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
